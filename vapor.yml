id: 6274
name: allcommerce-merchants
separate-vendor: true
environments:
  production:
    domain: ac-merchants.capeandbay.com
    memory: 1024
    cli-memory: 512
    cli-timeout: 600
    timeout: 60
    gateway-version: 2
    database: allcommerce
    database-user: acuser
    runtime: php-7.4
    queues:
      - aco-production-shopify
    build:
      - 'composer install --no-dev'
      - 'php artisan event:cache'
      - 'curl -sL https://deb.nodesource.com/setup_10.x | bash -'
      - 'apt-get install -y nodejs'
      - 'npm install && npm run prod && rm -rf node_modules'
    deploy:
      - 'php artisan migrate --force'
  staging:
      domain: ac-merchants-dev.capeandbay.com
      memory: 1024
      cli-memory: 512
      cli-timeout: 600
      timeout: 60
      gateway-version: 2
      database: allcommerce
      database-user: acuser
      runtime: php-7.4
      queues:
        - aco-staging-shopify
      build:
        - 'composer install'
        - 'php artisan event:cache'
        - 'curl -sL https://deb.nodesource.com/setup_10.x | bash -'
        - 'apt-get install -y nodejs'
        - 'npm install && npm run dev && rm -rf node_modules'
      deploy:
        - 'php artisan migrate --force'
  develop:
      memory: 1024
      cli-memory: 512
      cli-timeout: 600
      timeout: 60
      gateway-version: 2
      database: allcommerce
      database-user: acuser
      runtime: php-7.4
      queues:
        - aco-develop-shopify
      build:
        - 'apt-get update && apt-get install -y npm'
        - 'composer install --classmap-authoritative'
        - 'php artisan event:cache'
        - 'npm install && npm run dev && rm -rf node_modules'
      deploy:
        - 'php artisan migrate --force'
